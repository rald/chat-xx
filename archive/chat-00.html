<!doctype hmtl>
<html>
  <head>
 		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>chat</title>
		<style>
		  html, body {
		    width: 100%;
		    height: 100%;
		    overscroll-behavior: contain;
		    overflow: hidden;
		    margin: 0;
		    padding: 0;
		  }
		</style>
  </head>
  <body>




<script>



//	----------------------
//	--- Calc Functions ---
//	----------------------



doc=document;
body=doc.body;
say=(x)=>doc.write(x+'<br>');
ask=(m)=>window.prompt(m);
sayl=(x)=>console.log(x);
str=(n,b=10)=>n.toString(b);
pars=(s,b)=>parseInt(s,b);
pflt=(s)=>parseFloat(s);
ran=(x)=>int(Math.random()*x);
ranr=(b,e)=>rnd(int(e)-int(b)+1)+int(b);
div=(x,y)=>int(x/y);
mod=(x,y)=>int(x%y);
chr=(c)=>String.fromCharCode(c);
ord=(s,i=0)=>s.charCodeAt(i);
sin=(x)=>Math.sin(x);
cos=(x)=>Math.cos(x);
tan=(x)=>Math.tan(x);
log=(x)=>Math.log(x);
base=(x,y)=>log(y)/log(x);
make=(e)=>doc.createElement(e);
add=(o,e)=>o.append(e);
ani=f=>window.requestAnimationFrame(f);
sint=(f,t)=>window.setInterval(f,t);
sout=(f,t)=>window.setTimeout(f,t);
fac=(n)=>{var r=n;if(n===0||n===1)return 1;while(n>1){n--;r*= n;}return r;}
nPr=(n,r)=>fac(n)/fac(n-r);
nCr=(n,r)=>fac(n)/fac(r)*fac(n-r);
perp=(n,N)=>(n/N)*100;
pern=(p,N)=>(p*N)/100;
rnd=(x)=>Math.round(x);
abs=(x)=>Math.abs(x);
sgn=(x)=>x<0?-1:x>0?1:0;
ceil=(x)=>Math.ceil(x);
flr=(x)=>Math.floor(x);
trc=(x)=>Math.trunc(x);
clamp=(x,b,e)=>x<=b?b:x>=e?e:x;
PI=Math.PI;
d2r=PI/180.0;
r2d=180/PI;
trim=(s)=>s.trim();
sqrt=(x)=>Math.sqrt(x);
mxm=(a)=>{var l=a[0];for(var i=1;i<a.length;i++)if(l<a[i]) l=a[i];return l;};
mnm=(a)=>{var l=a[0];for(var i=1;i<a.length;i++)if(l>a[i]) l=a[i];return l;};


// --------------------------
// --- graphics functions ---
// --------------------------



gctx=(c)=>c.getContext("2d");
txt=(c,t,x,y,f)=>{c.fillStyle=f;c.fillText(t,x,y);}
pset=(c,x,y,f,s)=>{c.fillStyle=f;c.fillRect(x*s,y*s,s,s);}
pget=(c,x,y)=>{let d=c.getImageData();return new Color(d.data[0],d.data[1],d.data[2],d.data[3]);}
clear=(c,f)=>{c.fillStyle=f;c.fillRect(0,0,c.canvas.width,c.canvas.height);}
rgba=(c)=>`rgba(${c.r},${c.g},${c.b},${c.a})`;
line=(c,x0,y0,x1,y1,s)=>{c.beginPath();c.strokeStyle=s;c.moveTo(x0,y0);c.lineTo(x1,y1);c.stroke();c.closePath();}
rect=(c,x,y,w,h,s)=>{c.beginPath();c.strokeStyle=s;c.rect(x,y,w,h);c.stroke();c.closePath();}
circ=(c,x,y,r)=>{c.beginPath();c.strokeStyle=s;c.arc(x,y,r,0,Math.PI*2);c.stroke();c.closePath();}
inrect=(x,y,rx,ry,rw,rh)=>x>=rx && x<=rx+rw && y>=ry && y<=ry+rw;
incirc=(x,y,rx,ry,rr)=>x*x-y*y<=r*r;
dist=(x0,y0,x1,y1)=>{var dx=x1-x0;var dy=y1-y2;return sqrt(dx*dx+dy*dy);}
frect=(c,x,y,w,h,f)=>{c.fillStyle=f;c.fillRect(x,y,w,h);}
sum=(a)=>{return a.reduce((b,c)=>b+c,0)};


//	-------------------
//	--- Color Class ---
//	-------------------



class Color {
  constructor(r,g,b,a) {
    this.r=r;
    this.g=g;
    this.b=b;
    this.a=a;
	}
}




//	---------------------
//	--- Color Palette --- 
//	--------------------- 



// sweetie-16 color palette by GrafxKid  
const pal=[
  new Color(26,28,44,1),
  new Color(93,39,93,1),
  new Color(177,62,83,1),
  new Color(239,125,87,1),
  new Color(255,205,117,1),
  new Color(167,240,112,1),
  new Color(56,183,100,1),
  new Color(37,113,121,1),
  new Color(41,54,111,1),
  new Color(59,93,201,1),
  new Color(65,166,246,1),
  new Color(115,239,247,1),
  new Color(244,244,244,1),
  new Color(148,176,194.1),
  new Color(86,108,134,1),
  new Color(51,60,87,1),
];  



//  ---------------------
//  --- Program Below ---
//	---------------------

var x=0,y=0;

var tx=0,ty=0,td=0;
var touches=null;
ttouch=(e,d)=>{
	touches=e.touches;
	td=0;
	if(touches.length>0) {
		var r=P.getBoundingClientRect();
		tx=touches[touches.length-1].clientX-r.x;
		ty=touches[touches.length-1].clientY-r.y;
		td=d;
	}
}
tstart=(e)=>ttouch(e,1);
tmove=(e)=>ttouch(e,1);
tend=(e)=>ttouch(e,0);

body.style.background=rgba(pal[15]);

x=0;
y=0;
w=16;
h=16;
mem=new Uint8Array(w*h);
for(var i=0;i<mem.length;i++) mem[i]=0;

sw=window.innerWidth;
sh=window.innerHeight;

const C=make('canvas');
const c=gctx(C);
C.width=w*16;
C.height=h*16;
add(body,C);
C.style.position="absolute";
cx=flr((sw-C.width)/2);
cy=8;
C.style.left=`${cx}px`;
C.style.top=`${cy}px`;

const P=make('canvas');
const p=gctx(P);
P.width=320;
P.height=240;
add(body,P);
P.style.position="absolute";
px=flr((sw-P.width)/2);
py=8+8+256;
P.style.left=`${px}px`;
P.style.top=`${py}px`;

P.addEventListener('touchstart',tstart);
P.addEventListener('touchmove',tmove);
P.addEventListener('touchend',tend);


clear(c,rgba(pal[0]));
clear(p,rgba(pal[0]));

c.translate(0.5,0.5); // fix pixel overlap
p.translate(0.5,0.5); // fix pixel overlap

c.font="normal 16px monospace";
c.textAlign="left";
c.textBaseline="top";



/*
pad=(ox,oy)=>{
	ox+=gx;
	oy+=gy;

	p.font="bold 12px sans";
	p.textAlign="center";
	p.textBaseline="middle";
	
	for(var j=0;j<b[m].length;j++) {
		cx=flr((P.width-b[m][j].length*(sx+gx))/2);
		cy=flr((P.height-b[m].length*(sy+gy))/2);
		for(var i=0;i<b[m][j].length;i++) {
	
			var kk=b[m][j][i];

			if(trim(kk).length>0) {
				var r=P.getBoundingClientRect();

				if(
					(ksh===1 && kk==="SHF") ||
					(kcl===1 && kk==="CTL") ||
					(kal===1 && kk==="ALT")
				) frect(p,(sx+gx)*i+ox+cx,(sy+gy)*j+oy+cy,sx,sy,rgba(pal[3]));

				if(td) {
					
					if(inrect(tx,ty,(sx+gx)*i+ox+cx,(sy+gy)*j+oy+cy,sx,sy)) {
				
						kp=1;
	
						frect(p,(sx+gx)*i+ox+cx,(sy+gy)*j+oy+cy,sx,sy,rgba(pal[3]));
	
						if(hd==0) {
							
							hd=1;
							key=ord(kk);
							if(kk==="SHF") { 
								key=0; 
								m=m==0?1:0;  
								ksh=1-ksh; 
							} else if(kk==="CTL") { 
								key=0; 
								kcl=1-kcl; 
							} else if(kk==="ALT") { 
								key=0; 
								kal=1-kal; 
							} else if(kk==="FN") {
								key=0; 
								m=m==2?0:2;
							} else if(kk==="LF") {
								key=0; 
								if(x>0) {
									x--;
								} else if(y>0) {
									x=w-1;
									y--;
								}
							} else if(kk==="DN") {
								key=0; 
								if(y<h-1) {
									y++;
									if(y>h-1) y=h-1;
								}
							} else if(kk==="UP") {
								key=0; 
								if(y>0) y--;
							} else if(kk==="RT") {
								key=0;
								x++;
								if(x>w-1) {
									y++;
									if(y<h-1) {
										x=0;
									} else {
										x=w-1;
										y=h-1;
									}
								}
							} else if(kk==="SPC") {
								key=32;
								mem[y*w+x]=key;
			 			
			 	 				if(x==w-1 && y==h-1) {
									x=0;
									y=h-1;
									for(var ui=0,uj=16;uj<256;ui++,uj++) {
										mem[ui]=mem[uj];
										mem[uj]=0;
									}
								} else {
									x++;
									if(x>w-1) {
										x=0;
										if(y<h-1) y++;
									}
								}
							} else if(kk==="ENT") {
								key=0; 
								x=0;
								if(y<h-1) {
									y++;
								} else {
									for(var ui=0,uj=16;uj<256;ui++,uj++) {
										mem[ui]=mem[uj];
										mem[uj]=0;
									}									
								}
							} else if(kk==="BCK") {
								if(x>0) { 
									x--;
								} else if(y>0) {
									x=w-1;
									y--;
								} else {
									x=0;
									y=0;
								}
								key=32; 
								mem[y*w+x]=key;
							} else {
								ksh=kcl=kal=kfn=0;
								mem[y*w+x]=key;
			 			
			 	 				if(x==w-1 && y==h-1) {
									x=0;
									y=h-1;
									for(var ui=0,uj=16;uj<256;ui++,uj++) {
										mem[ui]=mem[uj];
										mem[uj]=0;
									}
								} else {
									x++;
									if(x>w-1) {
										x=0;
										if(y<h-1) y++;
									}
								}
								
							}
						}
					}		
				} else {
					hd=0;
					key="";
					kp=0;
				}
		
				rect(p,(sx+gx)*i+ox+cx,(sy+gy)*j+oy+cy,sx,sy,rgba(pal[12]));
				txt(p,kk,(sx+gx)*i+ox+cx+sx/2,(sy+gy)*j+oy+cy+sy/2,rgba(pal[12]));
			}
		}	
	}
}
*/

class Pad {

	constructor(x,y) {
		this.mode=0;
		this.sizeX=28;
		this.sizeY=32;
		this.gapX=2;
		this.gapY=2;
		this.hold=0;
		this.ksh=0;
		this.kcl=0;
		this.kal=0;
		this.kfn=0;
		this.key="";
	}
	
	static const keys=[
	[
		["1","2","3","4","5","6","7","8","9","0"],
		["q","w","e","r","t","y","u","i","o","p"],
		["a","s","d","f","g","h","j","k","l","ENT"],
		["SHF","TAB","z","x","c","v","b","n","m","BCK"],
		["CTL","ALT","FN","SPC",",",".","/","FN","ALT","CTL"],
		["LF","DN","UP","RT"]
	],
	
	[
		["!","@","#","$","%","^","&","*","(",")"],
		["Q","W","E","R","T","Y","U","I","O","P"],
		["A","S","D","F","G","H","J","K","L","ENT"],
		["SHF","TAB","Z","X","C","V","B","N","M","BCK"],
		["CTL","ALT","FN","SPC",",",".","/","FN","ALT","CTL"],
		["LF","DN","UP","RT"]
	],
	
	[
		["ESC","","F1","F2","F3","F4","F5","F6","BRK","BCK"],
		["","","F7","F8","F9","F10","F11","F12","INS","PUP"],
		["\"","~","_","+","{","}","|",":","DEL","PDN"],
		["'","`","-","=","[","]","\\",";","HME","END"],
		["CTL","ALT","FN","SPC",",",".","/","FN","ALT","CTL"],
		["LF","DN","UP","RT"]
	],
	
];

}


draw=()=>{
	clear(c,rgba(pal[0]));
	clear(p,rgba(pal[0]));

	

	c.font="bold 16px monospace";
	c.textAlign="center";
	c.textBaseline="middle";


/*	
	for(var k=0;k<mem.length;k++) {
		var i=k%16;
		var j=flr(k/16);
		txt(c,chr(mem[k]==0?32:mem[k]),i*16+16/2,j*16+16/2,rgba(pal[12]));
	}
*/
	
	rect(c,x*16,y*16,15,15,rgba(pal[12]));
	
	ani(draw);
}

ani(draw);

//  -------------------
//  --- End Program ---
//	-------------------



</script>    
  </body>
</html>
